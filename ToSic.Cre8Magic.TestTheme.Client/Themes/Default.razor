@namespace ToSic.Cre8magic.TestTheme.Client
@using ToSic.Cre8magic.Components.Internal
@inherits MyThemeBase
@*
File Purpose:       Core theme file and Default variation
Recommendations:    -
Nice to know:
    - Inherits from ThemeBase, which has some additional logic to make things happen
    - The other theme files inherit from this, and will also use the HTML here
*@
@code
{
    public override string Name => "Default";
    public override string Layout => "default";
    protected override string MagicContextClasses => "floatwideheader";

    [Parameter, SupplyParameterFromQuery]
    public string TestSettings { get; set; }

    public Dictionary<string, string> TestSettingsDic = new()
    {
        { "default", "default (json)" }, // leave test as is, using base settings
        { "catalog", "use custom catalog" }, // use full custom catalog
    };

    // /// <summary>
    // /// Test parameters - use alternate settings for various tests
    // /// </summary>
    // protected override void OnInitialized()
    // {
    //     base.OnInitialized();
    // }

    protected override void OnParametersSet()
    {
        base.OnParametersSet();
        switch (TestSettings)
        {
            case "default":
                MagicHat.UseSettings(ThemePackageSettings, Layout);
                MagicHat.UseSettingsCatalog(null);
                break;
            case "catalog":
                MagicHat.UseSettingsCatalog(ThemeSettingsForTests.Catalog1);
                break;
        }
    }
}
@*
    The MagicContextAndSettings wrapper does 2 things
    1. It ensures that certain classes are added to the body or wrapper-div so that styles can be optimized by page, language, branch etc.
       Note that the specifics are configured in the configuration
    2. It will ensure that the object Settings are available on all child controls using <CascadingValue>
*@
<MagicContextAndSettings Settings="new() { Classes = MagicContextClasses }">

    <ul class="navbar-nav" style="flex-direction: row;">
        @foreach (var pair in TestSettingsDic)
        {
            var isActive = TestSettings == pair.Key;
            
            <li class="nav-item">
                <a class='navbar-link @(isActive ? "active" : "")' href='@MagicHat.Link(PageState, new() { QueryString = "TestSettings=" + pair.Key })' title="@pair.Value">@pair.Key</a>
                &nbsp;&nbsp;
            </li>
        }
    </ul>

    @* Show any errors to the admin if something went wrong like when loading settings *@
    <MagicExceptions></MagicExceptions>

    @* Header with logo and navigation etc. *@
    <Header></Header>

    @* Header Pane *@
    <div id="@ThemeKit.Designer.Id("sectionHeader")" class='@ThemeKit.Designer.Classes("sectionHeader") @ThemeKit.Designer.PaneClasses("Header")'>
        <Pane Name="Header"/>
    </div>

    @* Main Section *@
    <main id="@ThemeKit.Designer.Id("sectionMain")" class="@ThemeKit.Designer.Classes("sectionMain")">

        @* Show Breadcrumb if desired *@
        @if (ThemeKit.ShowPart("breadcrumbs"))
        {
            <Breadcrumbs></Breadcrumbs>
        }

        @* If we show the Sidebar, then it must be side-by-side with the Content *@
        @if (ThemeKit.ShowPart("menuSidebar"))
        {
            <div class="container">
                <div class="row">
                    <div class='@ThemeKit.Designer.Classes("sidebarBody")'>
                        <Pane Name="@PaneNames.Default"/>
                        <MagicShowComponents Components="@MagicComponents"></MagicShowComponents>
                    </div>
                    <div class='@ThemeKit.Designer.Classes("sidebarMenu")'>
                        <div id="@ThemeKit.Designer.Id("sidebarMenu-inner")" class="@ThemeKit.Designer.Classes("sidebarMenu-inner")">
                            <MagicMenu PartName="@ThemeInfo.MenuSidebar"></MagicMenu>
                        </div>
                    </div>
                </div>
            </div>
        }
        else
        {
            <Pane Name="@PaneNames.Default"/>
            <MagicShowComponents Components="@MagicComponents"></MagicShowComponents>
        }

        <ToTop></ToTop>
    </main>
    <Footer></Footer>
</MagicContextAndSettings>